{% extends "Scraper/base.html" %}
{% block title %}{{ title }}{% endblock %}
{% block content %}
<h3 class="header center orange-text">{{ title }}</h3>
<br><br>
<div class="row">
    <div class="col s12 m3 center-align">
	<img src="http://{{ request.get_host }}/{{ MEDIA_URL }}images/{{ poster_name }}" width='220px' alt="{{ title }}">
	<br>
    </div>
    <div class="col s12 m9">
	{% for x, y in description.items %}
	<strong>{{x}}</strong>:&nbsp;&nbsp;{{y|safe}}
	<br>
	{% endfor %}
    </div>
</div>
<br>
<div class="divider"></div>
<br>
<h4 class="header center orange-text">Episodes</h4>
<div class="row center" style="padding:5%;">
    <div class="col s12 m6">
	<button style="margin-bottom:2%;width:100%;"
		class="waves-effect waves-light btn" id="play-btn" disabled>Play</button>
    </div>
    <div class="col s12 m6">
	<button style="margin-bottom:2%;width:100%;"
		class="waves-effect waves-light btn" id="download-btn">Download</button>
    </div>
    <br>
    <div class="col s12 m6">
	<button style="margin-bottom:2%;width:100%;"
		class="waves-effect waves-light btn" id="sall-cb">Select All</button>
    </div>
    <div class="col s12 m6">
	<button style="margin-bottom:2%;width:100%;"
		class="waves-effect waves-light btn" id="dall-cb">Deselect All</button>
    </div>
</div>
<div class="row" id="eps-cbs">
    {% for i in ep_nums %}
    <div class="col s2 m1">
	<p>
	    <input type="checkbox" id="ep-{{ i }}" class="ep-cb" />
	    <label for="ep-{{ i }}">{{ i }}</label>
	</p>
    </div>
    {% endfor %}
    <script type="text/javascript">
     $("#sall-cb").click(function() {
	 ep_cbs = $("#eps-cbs").find(".ep-cb");
	 for (var i=0, n = ep_cbs.length; i < n; i++) {
	     ep_cbs[i].setAttribute("checked", "checked");
	 }
     });
     $("#dall-cb").click(function() {
	 ep_cbs = $("#eps-cbs").find(".ep-cb");
	 for (var i=0, n = ep_cbs.length; i < n; i++) {
	     ep_cbs[i].setAttribute("checked", ""); // IE. Wtf.
	     ep_cbs[i].removeAttribute("checked"); // For other browsers...
	 }
     });
     $("#download-btn").click(function() {
	 ep_cbs = $("#eps-cbs").find(".ep-cb");
	 let download_eps = "";
	 for (var i=0, n = ep_cbs.length; i < n; i++) {
	     if (ep_cbs[i].checked) {
		 download_eps += ep_cbs[i].id + ",";
	     }
	 }
	 if (download_eps) {
	     download_eps = download_eps.substr(0, download_eps.length-1);
	     window.open("{% url 'download' aid %}?d="+download_eps, "_self");
	 }
     });
    </script>
</div>
<!--<p>{{ debug_txt }}</p>-->
{% endblock %}
